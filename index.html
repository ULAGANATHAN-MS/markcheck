const fs = require('fs');
const xlsx = require('xlsx');

function displayResult(registerNumber, filePath) {
    const workbook = xlsx.readFile(filePath);
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];

    // Assuming register numbers are in column A and results are in column B
    const registerColumn = 'A';
    const resultColumn = 'B';

    const registerAddress = `${registerColumn}1:${registerColumn}${sheet['!ref'].e.r}`;
    const resultAddress = `${resultColumn}1:${resultColumn}${sheet['!ref'].e.r}`;

    const registerNumbers = xlsx.utils.sheet_to_json(sheet, { range: registerAddress });
    const results = xlsx.utils.sheet_to_json(sheet, { range: resultAddress });

    const registerIndex = registerNumbers.findIndex((row) => row[registerColumn] === registerNumber);

    if (registerIndex !== -1) {
        const result = results[registerIndex][resultColumn];
        console.log(`Result for Register Number ${registerNumber}: ${result}`);
    } else {
        console.log(`Register Number ${registerNumber} not found.`);
    }
}

// Example: Call the function with a specific register number and file path
const targetRegisterNumber = '12345'; // Replace with the desired register number
const excelFilePath = 'path/to/your/excel/file.xlsx'; // Replace with the path to your Excel file

displayResult(targetRegisterNumber, excelFilePath);
